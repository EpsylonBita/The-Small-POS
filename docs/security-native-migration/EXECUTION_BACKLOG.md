# POS Tauri Execution Backlog

## Security Hotfixes
- [x] Disable legacy PowerShell print path
- [x] Escape receipt preview HTML dynamic content
- [x] Persist lockout counters
- [x] Stop mirroring sensitive credentials to local_settings
- [x] Remove legacy plaintext simple PIN write path
- [x] Replace permissive IPC security shim

## Near-Term (2-4 weeks)
- [x] Implement centralized external URL allowlist in Rust command layer
- [x] Add tests for IPC blocked channel invocation behavior
- [x] Add tests for lockout persistence across process restart simulation
- [x] Remove remaining localStorage identity persistence in renderer critical paths

## Mid-Term (5-8 weeks)
- [x] Split `src-tauri/src/lib.rs` into domain command modules (started: `commands/auth.rs`, `commands/settings.rs`, `commands/system_ui.rs`, `commands/diagnostics.rs`, `commands/updates.rs`, `commands/hardware.rs`, `commands/api_bridge.rs`, `commands/modules.rs`, `commands/analytics.rs`, `commands/sync.rs`, `commands/orders.rs`, `commands/payments.rs`, `commands/menu.rs`, `commands/print.rs`, `commands/shifts.rs`, `commands/customers.rs`, `commands/zreports.rs`, `commands/ecr.rs`, and `commands/runtime.rs` extracted; final inline dashboard/cash-drawer stubs moved into command modules; terminal/settings helper cluster extracted to `src-tauri/src/terminal_helpers.rs`; shared admin/cache/update helper cluster extracted to `src-tauri/src/core_helpers.rs`; shared local-data/order/url helper cluster extracted to `src-tauri/src/data_helpers.rs`)
- [x] Introduce typed command payload/result schemas shared with renderer (started in `commands/orders.rs` for `order_update_status`, `order_update_items`, and `order_delete` compatibility parsers + DTO tests; extended in `commands/payments.rs` for payment/refund status+void and ID lookup command parsers + DTO tests; extended in `commands/sync.rs` for remove-invalid-orders, failed/retry financial sync item, room status, and drive-through status compatibility parsers + DTO tests; extended in `commands/shifts.rs` for active/summaries/expenses/staff-payments/schedule compatibility parsers + DTO tests; extended in `commands/customers.rs` for lookup/search/update/address/conflict compatibility parsers + DTO tests; extended in `commands/menu.rs` for subcategory/update toggle compatibility parsers + DTO tests; extended in `commands/analytics.rs` for driver/report/delivery-zone compatibility parsers + DTO tests; extended in `commands/zreports.rs` for generate/get/list/print compatibility parsers + DTO tests; extended in `commands/print.rs` for receipt/printer/label compatibility parsers + DTO tests; extended in `commands/ecr.rs` for device/payment/transaction compatibility parsers + DTO tests; extended in `commands/api_bridge.rs` for admin fetch compatibility parsers + DTO tests; extended in `commands/runtime.rs` for external-open and screen-capture compatibility parsers + DTO tests; extended in `commands/system_ui.rs` for clipboard/notification compatibility parsers + DTO tests; extended in `commands/hardware.rs` for serial/scale/display/scanner/loyalty compatibility parsers + DTO tests; extended in `commands/modules.rs` for module cache compatibility parsers + DTO tests; extended in `commands/updates.rs` for update-channel compatibility parsers + DTO tests; extended in `commands/auth.rs` for permission payload compatibility parsers + DTO tests; extended in `commands/settings.rs` for settings set/update-local/terminal-config compatibility parsers + DTO tests; extended in `commands/diagnostics.rs` for diagnostics export options compatibility parser + DTO tests; command-module DTO parser coverage is now complete; shared renderer-native DTO contracts started via `src/lib/ipc-contracts.ts` + typed `ipc-adapter` diagnostics/settings/terminal-config/sync/auth signatures (including `sync.validatePendingOrders`, `sync.removeInvalidOrders`, and object payload support for `auth.setupPin`), renderer diagnostics page migration away from raw `invoke`, terminal/settings consumer migration in `renderer/services/terminal-credentials.ts` + `renderer/components/modals/ConnectionSettingsModal.tsx`, raw settings/terminal migration in `renderer/App.tsx` + `renderer/pages/LoginPage.tsx`, language settings migration in `renderer/contexts/i18n-context.tsx`, local-order/customer terminal credential migration in `renderer/components/modals/AddCustomerModal.tsx` + `services/OrderService.ts`, order item fetch migration in `renderer/components/modals/MenuModal.tsx` + `renderer/components/modals/EditOrderItemsModal.tsx` + `renderer/components/order/OrderApprovalPanel.tsx`, terminal-settings event + receipt print migration away from `window.electronAPI` in `renderer/components/modals/AddCustomerModal.tsx` + `renderer/components/order/OrderApprovalPanel.tsx`, delivery analytics/window-control migration away from raw `window.electronAPI` in `services/DeliveryZoneValidator.ts` + `renderer/components/CustomTitleBar.tsx`, and module/runtime app-event migration away from raw `window.electron` in `renderer/contexts/module-context.tsx` + `renderer/hooks/useAppEvents.ts`)
- [x] Migrate remaining App/updater/order/sync-status/report/menu/users renderer IPC call sites to typed bridge (`renderer/App.tsx`, `renderer/hooks/useAutoUpdater.ts`, `renderer/hooks/useScheduledShifts.ts`, `renderer/hooks/useOrderStore.ts`, `renderer/hooks/useErrorHandler.ts`, `renderer/hooks/useActiveDrivers.ts`, `renderer/hooks/useDiscountSettings.ts`, `renderer/hooks/useFeaturedItems.ts`, `renderer/contexts/shift-context.tsx` (terminal restore + active shift fetch + terminal-settings event bridge migration), `renderer/pages/OnboardingPage.tsx`, `renderer/pages/OrdersPage.tsx`, `renderer/pages/NewOrderPage.tsx`, `renderer/pages/PaymentTerminalsPage.tsx` (ECR invoke/event bridge migration + response normalization), `renderer/components/ecr/PaymentTerminalsSection.tsx` (ECR invoke/event bridge migration + response normalization), `renderer/components/modals/CustomerOrderHistoryModal.tsx`, `renderer/components/modals/ExpenseModal.tsx`, `renderer/components/modals/StaffShiftModal.tsx` (full check-in/check-out/auth/expense/print bridge migration), `renderer/components/modals/ConnectionSettingsModal.tsx` (PIN/security/database/peripheral command bridge migration), `renderer/components/modals/ZReportModal.tsx`, `renderer/components/SyncNotificationManager.tsx`, `renderer/components/SyncStatusIndicator.tsx`, `renderer/components/FinancialSyncPanel.tsx`, `renderer/components/OrderSyncRouteIndicator.tsx`, `renderer/components/OrderFlow.tsx`, `renderer/components/OrderDashboard.tsx`, `renderer/components/order/OrderStatusControls.tsx`, `renderer/components/dashboards/FoodDashboard.tsx`, `renderer/components/dashboards/ProductDashboard.tsx`, `renderer/components/dashboards/ServiceDashboard.tsx`, `renderer/services/CustomerService.ts`, `renderer/services/ServicesService.ts` (bridge invoke fallback migration), `renderer/services/MenuService.ts` (bridge invoke fallback migration), `renderer/services/ReservationsService.ts` (bridge invoke fallback migration), `renderer/utils/api-helpers.ts` (native admin API bridge + terminal auth header bridge migration), `renderer/pages/InventoryPage.tsx` (bridge invoke fallback migration), `renderer/pages/SuppliersPage.tsx` (bridge invoke fallback migration), `renderer/pages/CouponsPage.tsx` (bridge invoke fallback migration), `renderer/pages/MenuManagementPage.tsx`, `renderer/pages/ReportsPage.tsx`, `renderer/pages/UsersPage.tsx`) and extend `ipc-adapter` sync fetch options + terminal credential payload aliases
- [x] Continue renderer bridge migration in remaining hook/service call sites (`renderer/hooks/useMenuVersionPolling.ts`, `renderer/hooks/useTables.ts`, `renderer/hooks/useRealTimeMenuSync.ts`, `renderer/hooks/useTerminalSettings.ts`, `renderer/hooks/useFeatures.ts`, `renderer/hooks/useDeliveryValidation.ts`, `renderer/hooks/useWindowState.ts`, `renderer/services/ActivityTracker.ts`, `renderer/services/DriveThruService.ts`, `renderer/services/RoomsService.ts`, `renderer/services/AppointmentsService.ts`, `renderer/services/ScreenCaptureHandler.ts`)
- [x] Remove last direct runtime `window.electronAPI` usage from core order/auth flows (`renderer/pages/LoginPage.tsx`, `renderer/components/OrderFlow.tsx`, `renderer/components/OrderDashboard.tsx`) and route through `onEvent/offEvent` + typed bridge (`terminalConfig`, `shifts`, `payments`, `customers`, `ecr`)
- [x] Replace legacy renderer `openExternalUrl` helper internals with bridge-native gateway invocation (`renderer/utils/electron-api.ts`) so policy enforcement no longer depends on direct `window.electronAPI` access
- [x] Remove remaining renderer direct `window.electron*` access in menu/tables/order/print surfaces and retire renderer Electron ambient d.ts (`renderer/pages/MenuPage.tsx`, `renderer/pages/TablesPage.tsx`, `renderer/components/order/OrderCard.tsx`, `renderer/components/RefactoredMainLayout.tsx`, `renderer/components/modals/PrinterSettingsModal.tsx`, `renderer/components/modals/OrderDetailsModal.tsx`, deleted `renderer/types/electron.d.ts`, and removed stale triple-slash references in `src/main.tsx`, `renderer/index.tsx`, `renderer/contexts/i18n-context.tsx`)
- [x] Replace remaining non-preload runtime `window.electron*` calls in startup/environment flows with typed bridge (`src/main.tsx`, `src/config/environment.ts`)
- [x] Start moving printer status orchestration from renderer polling to Rust background worker (`src-tauri/src/commands/print.rs` + `src-tauri/src/lib.rs` monitor loop emitting `printer_status_changed` snapshots; `renderer/components/modals/PrinterSettingsModal.tsx` polling interval removed and switched to event-driven status updates)
- [x] Move sync/network orchestration from renderer polling to Rust sync loop events (`src-tauri/src/sync.rs` now emits `network_status` every cycle and aligns `sync_status.isOnline`; polling removed from `renderer/components/SyncStatusIndicator.tsx` and `renderer/components/OrderSyncRouteIndicator.tsx`)
- [x] Normalize financial sync telemetry contracts and consume Rust sync payloads before fallback fetches (`src-tauri/src/sync.rs` now embeds `pendingPaymentItems` + `failedPaymentItems` + `financialStats` in sync status events/queries; `src-tauri/src/commands/sync.rs` financial/failure queries aligned to actual queue entity types with compatibility aliases, and mutating sync commands (`retry`, `remove-invalid`, `clear-*`, `cleanup-deleted`) now emit immediate `network_status` + `sync_status` snapshots; `src/lib/ipc-adapter.ts` unwraps failed-financial `{ items }` responses; `renderer/components/SyncStatusIndicator.tsx` now prefers `sync_status.financialStats`; `renderer/components/FinancialSyncPanel.tsx` normalizes mixed payload shapes + event-driven refresh on `sync:complete`/`sync-retry-scheduled`)
- [x] Remove `OrderDashboard` API polling and keep updates event-driven (`renderer/components/OrderDashboard.tsx` removed 15s `silentRefresh` interval in favor of one-shot shift-activation refresh, preserving modal guard; external-order alert loop moved from `setInterval` to cancellable timeout chaining)
- [x] Move `SystemHealthPage` refresh from renderer polling to Rust background monitor (`src-tauri/src/commands/diagnostics.rs` adds `start_system_health_monitor` emitting `database_health_update`; `src-tauri/src/lib.rs` starts the monitor on app setup; `renderer/pages/SystemHealthPage.tsx` subscribes to `database-health-update` and removes 30s interval polling)
- [x] Remove dashboard/order list renderer polling loops and drive refresh from Rust-emitted sync/order events (`renderer/components/dashboards/ProductDashboard.tsx`, `renderer/components/dashboards/ServiceDashboard.tsx`, `renderer/pages/OrdersPage.tsx`, and `renderer/pages/KitchenDisplayPage.tsx` now subscribe to `sync:status`/`sync:complete` + `order-*` events with debounce/rate limiting; 30s `setInterval` loops removed)
- [x] Remove hook/page polling for shifts/tables/delivery and route refresh through Rust events (`renderer/hooks/useScheduledShifts.ts`, `renderer/hooks/useTables.ts`, and `renderer/pages/DeliveryPage.tsx` now subscribe to `sync:status`/`sync:complete` + `shift-updated`/`order-*` events with debounce and throttled background refresh; `setInterval` loops removed)
- [x] Remove driver/appointment hook polling in favor of sync-driven refresh (`renderer/hooks/useActiveDrivers.ts` and `renderer/hooks/useAppointments.ts` now refresh from `sync:status`/`sync:complete` (+ `shift-updated` for drivers) with throttle/debounce; interval polling removed)
- [x] Remove window-state and appointment-service polling internals (`renderer/hooks/useWindowState.ts` now listens to backend `window-state-changed` + native window signals; `src-tauri/src/commands/system_ui.rs` emits `window_state_changed` on window state commands; `src/lib/event-bridge.ts` maps new event; `renderer/services/AppointmentsService.ts::subscribeToUpdates` now uses sync events (desktop) or Supabase realtime fallback without interval polling)
- [x] Remove branch menu and hardware manager polling timers (`renderer/hooks/useBranchMenu.ts` now refreshes cache via `sync:*` + `menu:sync` events with debounce/throttle and no interval timer; `renderer/hooks/useHardwareManager.ts` now refreshes hardware status via `sync:*` + `hardware-config:update`/`terminal-config-updated` events and no interval polling)
- [x] Remove featured-items and activity-tracker interval polling (`renderer/hooks/useFeaturedItems.ts` now performs throttled refresh via `sync:*` + `menu:sync` events instead of 6-hour interval polling; `renderer/services/ActivityTracker.ts` replaces the 3s interval retry loop with event-triggered, backoff-based one-shot retries)
- [x] Remove `useMenuVersionPolling` interval loop and switch to sync/menu event triggers (`renderer/hooks/useMenuVersionPolling.ts` now schedules checks from `sync:status`, `sync:complete`, `menu:check-for-updates`, and `menu:sync` with interval-based throttling + startup delay, replacing `setInterval`)
- [x] Remove auto-theme minute polling (`renderer/contexts/theme-context.tsx` now uses boundary-based one-shot scheduling for 06:00/18:00 transitions in auto mode instead of 60s interval checks)
- [x] Remove remaining trial/drive-through renderer interval timers (`renderer/components/modules/TrialModulePrompt.tsx` now updates trial countdown via minute-boundary timeout chaining; `renderer/pages/verticals/fast-food/DriveThruView.tsx` now drives elapsed-time re-renders via second-boundary timeout chaining)
- [x] Move drive-through realtime orchestration off renderer Supabase subscriptions (`renderer/hooks/useDriveThru.ts` now refreshes from native `sync:*` + `order-*` events with throttled background fetches; legacy `drive_thru_*` table channel subscription code removed from `renderer/services/DriveThruService.ts`)
- [x] Move services and reservations realtime orchestration off renderer Supabase subscriptions (`renderer/hooks/useServices.ts` + `renderer/hooks/useReservations.ts` now refresh from native `sync:*` + `order-*` events with throttled silent fetches; legacy realtime channel subscription code removed from `renderer/services/ServicesService.ts` + `renderer/services/ReservationsService.ts`)
- [x] Move product catalog/promotion realtime orchestration off renderer Supabase subscriptions (`renderer/hooks/useProductCatalog.ts` now refreshes via native `sync:*` + `order-*` event triggers with throttled silent fetches; legacy realtime channel subscription code removed from `renderer/services/ProductCatalogService.ts` and `renderer/services/PromotionsService.ts`)
- [x] Remove unused appointments realtime channel layer from service (`renderer/services/AppointmentsService.ts` subscription API + Supabase channel fallback removed; appointment refresh remains event-driven in `renderer/hooks/useAppointments.ts`)
- [x] Reduce desktop renderer Supabase fallback paths in reservations/product-catalog services (`renderer/services/ReservationsService.ts` now uses desktop API/IPC for single-reservation reads, status updates, table-reservation reads, and conflict checks before browser-only Supabase fallback; `renderer/services/ProductCatalogService.ts` now skips Supabase fallback in desktop runtime when API calls fail)
- [x] Remove remaining desktop Supabase reservation writes for create/assign flows (`admin-dashboard/src/app/api/pos/reservations/route.ts` now supports POS `POST` create; `admin-dashboard/src/app/api/pos/reservations/[reservationId]/route.ts` now supports POS table assignment via `PATCH` `table_id`; `admin-dashboard/src/lib/api/services/reservations.service.ts` create input supports room/check-in fields; `renderer/services/ReservationsService.ts` now routes `createReservation` + `assignTable` through `api:fetch-from-admin` on desktop with browser-only Supabase fallback)
- [x] Remove desktop renderer Supabase dependency in menu/screen-share runtime paths (`renderer/services/MenuService.ts` now uses IPC-first reads with browser-only Supabase fallback gates; `admin-dashboard/src/app/api/pos/screen-share/terminal/route.ts` adds POS-authenticated signal/status endpoints; `renderer/services/ScreenCaptureHandler.ts` now sends/polls screen-share signals through `api:fetch-from-admin` and no longer initializes a renderer Supabase client)
- [x] Remove admin LiveScreen direct Supabase signaling/subscription usage (`admin-dashboard/src/app/api/pos/screen-share/signals/route.ts` adds manager-authenticated signal/status polling and signal-write endpoints; `admin-dashboard/src/features/pos/components/LiveScreenModal.tsx` now sends ICE/answer and polls request status + terminal signals via `/api/pos/screen-share/signals`, removing browser Supabase table access in the modal)
- [x] Add regression coverage for screen-share signal API access/write controls (`admin-dashboard/tests/integration/api/pos-screen-share-signals.security.test.ts` validates manager ownership enforcement, admin read access with sender/time filters, stopped-session write rejection, and answer-signal status transition)
- [x] Move terminal screen-share signal polling loop into Rust runtime worker (`src-tauri/src/commands/runtime.rs` adds managed start/stop polling commands that emit `screen_capture_signal_batch`/error/stopped events via secure admin fetch; `src/lib/event-bridge.ts`, `src/lib/ipc-adapter.ts`, and `src/renderer/services/ScreenCaptureHandler.ts` now use native polling commands, and preload-era wiring has since been fully removed)
- [x] Remove renderer fallback polling from terminal screen-share flow and enforce native worker polling (`src/renderer/services/ScreenCaptureHandler.ts` no longer runs `setInterval`/HTTP polling fallback; startup failure now marks request failed and tears down capture without status clobber; `src-tauri/src/commands/runtime.rs` now validates UUID request IDs, bounds cursor length, and URL-encodes polling query params before admin fetch; shared typed screen-capture DTOs added in `src/lib/ipc-contracts.ts` and consumed by `src/lib/ipc-adapter.ts`)
- [x] Decommission unused Electron/Supabase realtime handler services (`src/services/RealtimeOrderHandler.ts` and `src/services/RealtimeCustomerHandler.ts` deleted after confirming no runtime imports remain; stale Electron-main realtime path removed in favor of native Rust sync/event pipeline)
- [x] Move more renderer orchestration to Rust background workers (`src-tauri/src/commands/menu.rs` now runs a background menu-version monitor that performs native cache sync checks and emits `menu_version_checked` + `menu_sync` events; `src-tauri/src/lib.rs` starts the worker at bootstrap; `renderer/hooks/useMenuVersionPolling.ts` now consumes native events and no longer performs renderer-side admin API menu-version polling)

## Finalization
- [x] Retire legacy Electron preload interfaces (final cutover removed `src/preload/index.ts`, `src/preload/ipc-security.ts`, and `src/preload/types/electron-stubs.d.ts`; renderer now relies on native `ipc-adapter` + `event-bridge` contracts)
- [x] Tighten Tauri capabilities to least privilege (`src-tauri/capabilities/default.json` now removes broad plugin grants and denies renderer `event.emit` + direct updater command surfaces; diagnostics folder-open flow moved off renderer `@tauri-apps/plugin-shell` and into native `diagnostics:open-export-dir` command in `src-tauri/src/commands/diagnostics.rs` with app-data path validation + OS-native folder open; `src-tauri/Cargo.toml` and `src-tauri/src/lib.rs` remove unused shell/dialog/notification/clipboard/process plugin runtime dependencies; `src-tauri/tauri.conf.json` shell plugin config removed)
- [x] Final security sign-off and regression run (`cargo check --keep-going`, targeted Rust DTO test for menu monitor snapshot parsing, `npm run type-check`, `npm run test:native-runtime`, and `npm run parity:contract` all pass; parity script now parses module-scoped Tauri commands correctly and classifies unresolved legacy optional channels separately from required parity gates)
- [x] Close optional legacy report/diagnostic/checkout IPC gaps with native command compatibility (`src-tauri/src/commands/analytics.rs` adds `report_get_hourly_sales`, `report_get_payment_method_breakdown`, `report_get_order_type_breakdown`, `report_print_z_report`; `src-tauri/src/commands/diagnostics.rs` adds `diagnostic_check_delivered_orders` + `diagnostic_fix_missing_driver_ids`; `src-tauri/src/commands/shifts.rs` adds `shift_print_checkout` compatibility response; `src-tauri/src/lib.rs` registers all new commands; `src/lib/ipc-adapter.ts` maps/exports typed bridge methods for all seven channels; validation rerun: `cargo check --keep-going`, targeted Rust DTO tests for the new parsers, `npm run type-check`, `npm run test:native-runtime`, `npm run parity:contract`)
- [x] Eliminate remaining parity “unmapped hardware channel” debt by adding typed bridge surface + channel map coverage for scale/display/scanner/loyalty/hardware-manager invokes (`src/lib/ipc-adapter.ts` now defines `hardware` namespace in `PlatformBridge` and maps all 17 legacy channels including underscore and `hardware:*` forms; validation rerun: `npm run type-check`, `npm run test:native-runtime`, `npm run parity:contract` now reports 0 unmapped renderer channels)
- [x] Implement native `shift:print-checkout` ESC/POS print path (replaced compatibility `notImplemented` response in `src-tauri/src/commands/shifts.rs` with profile-aware raw print flow: resolve shift summary, resolve default printer profile, render role-aware checkout receipt via `escpos::EscPosBuilder`, and dispatch through `printers::print_raw_to_windows`; returns structured success/failure payloads for renderer fallback behavior; validation rerun: `cargo check --keep-going`, `npm run type-check`, `npm run test:native-runtime`, `npm run parity:contract`)
- [x] Implement native snapshot-based `report:print-z-report` thermal path (`src-tauri/src/commands/analytics.rs` now keeps persisted `zReportId` spool path, and adds direct snapshot print flow: resolve snapshot payload, resolve default printer profile, normalize key metrics across legacy/new shapes, render ESC/POS receipt via `escpos::EscPosBuilder`, and dispatch through `printers::print_raw_to_windows`; structured success/failure payload preserved for renderer browser-print fallback; validation rerun: `cargo check --keep-going`, targeted Rust DTO/helper tests, `npm run type-check`, `npm run test:native-runtime`, `npm run parity:contract`)
- [x] Reduce printer status log noise (`src-tauri/src/printers.rs` downgrades repetitive “Enumerated Windows printers” telemetry from `INFO` to `DEBUG` so 15-second polling does not flood production logs; `cargo check --keep-going` rerun clean)
- [x] Make menu monitor/sync offline-aware and suppress non-actionable warning spam (`src-tauri/src/commands/menu.rs` now classifies connectivity failures as offline state, emits throttled `INFO`/`DEBUG` logs instead of repeated warning failures, returns `{ success: true, updated: false, offline: true }` for `menu_sync` command when offline, and keeps menu version monitor events successful with cached-menu semantics during outages)
- [x] Eliminate debug-level periodic flood and enforce offline sync deferral/resume semantics (`src-tauri/src/printers.rs` now logs printer inventory only when the enumerated printer set actually changes, instead of every 15-second poll; `src-tauri/src/menu.rs` moves periodic request/cache telemetry to `TRACE` and suppresses connectivity warning duplication; `src-tauri/src/sync.rs` now skips remote sync cycles while offline (queue remains pending) and immediately resumes catch-up sync on offline->online transition with explicit transition logs)
- [x] Complete native-only desktop cutover (removed compat bootstrap from `src/main.tsx`; reduced `platform-detect` to `tauri|browser`; removed `ElectronBridge` from `src/lib/ipc-adapter.ts`; refactored `src/lib/event-bridge.ts` to direct Tauri listen/unlisten dispatch with retained `onEvent/offEvent` API; deleted Electron/preload surfaces `src/lib/electron-compat.ts`, `src/preload/index.ts`, `src/preload/ipc-security.ts`, `src/preload/types/electron-stubs.d.ts`; deleted dead `src/services/printer-service.ts`; replaced preload-era guard with native checks `scripts/check-no-electron-surfaces.mjs` + `scripts/check-native-bootstrap.mjs` and `npm run test:native-runtime`)
- [x] Consolidate documentation to native-only source-of-truth structure (`README.md`, `ARCHITECTURE.md`, `PARITY_GATES.md`, `PARITY_CHECKLIST.md`, phase history notes, and `docs/README.md` + `docs/security-native-migration/README.md` refreshed; legacy parity snapshots archived under `docs/archive/parity/`)
- [x] Normalize operational docs to current runtime contracts (`RELEASE.md` and `SUPPORT.md` refreshed with native-only release flow, current verification commands, offline/online support runbooks, and updated escalation/data-location guidance)
- [x] Post-cutover automated verification pass completed (2026-02-22): `npm run type-check`, `npm run build`, `npm run parity:contract`, `npm run test:native-runtime`, `cargo check --keep-going`, and targeted Rust regressions (`sync::`, `menu::dto_tests`, `lockout_persists_across_auth_state_restart`, `successful_login_resets_persisted_lockout_after_restart`, `parse_external_url_payload_*`, `test_receipt_preview*`) all pass; note: broad selector run `cargo test --lib auth::` intermittently hit Windows Application Control `os error 4551`, while exact test-name invocations succeeded.
- [x] Make staging soak evidence collection repeatable (`scripts/tauri-smoke.mjs` now supports `--report <path>` JSON export and `--auto <pass|fail|skip>` dry-run mode; runbook added at `docs/security-native-migration/STAGING_SOAK_RUNBOOK.md`)
- [x] Add deterministic soak gate evaluator (`scripts/evaluate-soak-report.mjs` + `npm run soak:report`) so rollout approval requires zero skipped/failed critical gates.
- [ ] Manual staging pilot soak (24h with forced offline/online toggles) still pending: execute `node scripts/tauri-smoke.mjs --report docs/security-native-migration/reports/staging-soak-report.json` on a staging terminal and attach logs/admin evidence per `docs/security-native-migration/STAGING_SOAK_RUNBOOK.md`.

## Electron Decommission + Identifier Migration (Monorepo)
- [x] Decouple active CI/release tooling from legacy Electron app paths (`.github/workflows/pos-tauri-auto-release.yml`, `.github/workflows/security-scans.yml`, `.github/workflows/test.yml`, `scripts/make-ico.js`, `.gitignore`, and root `package.json` scripts)
- [x] Promote canonical desktop branding assets to `branding/pos-desktop/` and remove Electron icon dependency chain
- [x] Delete legacy Electron desktop app directory from the monorepo
- [x] Complete canonical identifier migration to `pos-tauri` on write paths with one-release read compatibility for legacy aliases
- [x] Add centralized platform/source normalization helper (`admin-dashboard/src/lib/platform-identifiers.ts`) and apply to admin/POS sync flows
- [x] Migrate analytics source canonical value to `pos_tauri` with one-release inbound legacy compatibility
- [x] Add compatibility-window DB migrations (`20260223000000_rename_pos_system_to_pos_tauri.sql`, `20260223000001_remove_pos_system_compatibility.sql`)
- [x] Purge legacy docs/spec archives and stale platform guides (`docs/archive/`, legacy desktop platform guide subtree)
- [x] Add regression guardrails (`scripts/check-no-pos-system-path-refs.mjs`, `scripts/check-platform-identifier-policy.mjs`) and wire them into CI + npm scripts
- [ ] Remove one-release compatibility aliases in release N+1 and apply follow-up migration `20260223000001_remove_pos_system_compatibility.sql`
