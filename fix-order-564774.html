<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix Order ORD-20251225-564774 Address</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }
        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
        }
        .sql-code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
        }
        .step {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .step h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #45a049;
        }
        button.secondary {
            background: #2196F3;
        }
        button.secondary:hover {
            background: #0b7dda;
        }
        .field-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .field-table th, .field-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .field-table th {
            background: #4CAF50;
            color: white;
        }
        .field-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Fix Order Address for ORD-20251225-564774</h1>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Issue Detected:</strong> This order is missing postal code and city in the database,
            so the driver assignment receipt doesn't show complete address information.
        </div>

        <div class="info-box">
            <h3>Current Receipt Shows:</h3>
            <ul>
                <li>‚úÖ Customer: Nikoleta Hachi</li>
                <li>‚úÖ Phone: 6948128471</li>
                <li>‚úÖ Street: Grigoriou Xenopoulou 21</li>
                <li>‚ùå Missing: 56224 Thessaloniki (postal + city)</li>
                <li>‚úÖ Bell: Haxhi</li>
            </ul>
        </div>

        <h2>üìã Step-by-Step Fix</h2>

        <div class="step">
            <h3>Step 1: Locate Database File</h3>
            <p>The POS system database is typically located in:</p>
            <code>C:\Users\[YourUsername]\AppData\Roaming\pos-system\pos-local.db</code>
            <p>Or check the app's user data directory.</p>
        </div>

        <div class="step">
            <h3>Step 2: Update Order Fields</h3>
            <p>Run this SQL command in the database:</p>

            <div class="sql-code">UPDATE orders SET
  delivery_city = 'Thessaloniki',
  delivery_postal_code = '56224',
  name_on_ringer = 'Haxhi',
  updated_at = datetime('now')
WHERE order_number = 'ORD-20251225-564774';</div>

            <button onclick="copySQL()">üìã Copy SQL</button>
        </div>

        <div class="step">
            <h3>Step 3: Verify Update</h3>
            <p>Check that the fields were updated correctly:</p>

            <div class="sql-code">SELECT
  order_number,
  customer_name,
  customer_phone,
  delivery_address,
  delivery_city,
  delivery_postal_code,
  delivery_floor,
  name_on_ringer
FROM orders
WHERE order_number = 'ORD-20251225-564774';</div>

            <button class="secondary" onclick="copyVerifySQL()">üìã Copy Verify SQL</button>
        </div>

        <div class="step">
            <h3>Step 4: Re-assign Driver to Print Updated Receipt</h3>
            <p>In the POS system:</p>
            <ol>
                <li>Go to the order dashboard</li>
                <li>Find order <strong>ORD-20251225-564774</strong></li>
                <li>Re-assign the driver (assign to same driver again)</li>
                <li>The receipt will now print with complete address:</li>
            </ol>

            <table class="field-table">
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Customer Name</td>
                        <td>Nikoleta Hachi</td>
                    </tr>
                    <tr>
                        <td>Phone</td>
                        <td>6948128471</td>
                    </tr>
                    <tr>
                        <td>Street Address</td>
                        <td>Grigoriou Xenopoulou 21</td>
                    </tr>
                    <tr>
                        <td><strong>Postal Code + City</strong></td>
                        <td><strong>56224 Thessaloniki</strong></td>
                    </tr>
                    <tr>
                        <td>Bell Name</td>
                        <td>Haxhi</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="success-box">
            <h3>‚úÖ Future Orders</h3>
            <p>New orders created from now on will automatically include all address fields (city, postal code, floor, bell name)
            because the <code>OrderFlow.tsx</code> has been updated to extract and save these fields from the customer's address.</p>
        </div>

        <h2>üõ†Ô∏è Tools to Run SQL</h2>
        <ul>
            <li><strong>DB Browser for SQLite</strong> - <a href="https://sqlitebrowser.org/" target="_blank">Download here</a> (Recommended, user-friendly GUI)</li>
            <li><strong>Command Line:</strong> <code>sqlite3 path\to\pos-local.db</code></li>
            <li><strong>VSCode Extension:</strong> SQLite Viewer/Editor</li>
        </ul>

        <div class="info-box" style="margin-top: 30px;">
            <strong>üìù Note:</strong> The stitched border issue has also been fixed. The receipt will now show continuous
            dashes (‚îÄ‚îÄ‚îÄ‚îÄ) instead of separated ones (‚îÄ ‚îÄ ‚îÄ), and the border will automatically adjust to the longest address line.
        </div>
    </div>

    <script>
        function copySQL() {
            const sql = `UPDATE orders SET
  delivery_city = 'Thessaloniki',
  delivery_postal_code = '56224',
  name_on_ringer = 'Haxhi',
  updated_at = datetime('now')
WHERE order_number = 'ORD-20251225-564774';`;

            navigator.clipboard.writeText(sql).then(() => {
                alert('‚úÖ SQL copied to clipboard!');
            }).catch(() => {
                alert('‚ùå Failed to copy. Please copy manually.');
            });
        }

        function copyVerifySQL() {
            const sql = `SELECT
  order_number,
  customer_name,
  customer_phone,
  delivery_address,
  delivery_city,
  delivery_postal_code,
  delivery_floor,
  name_on_ringer
FROM orders
WHERE order_number = 'ORD-20251225-564774';`;

            navigator.clipboard.writeText(sql).then(() => {
                alert('‚úÖ Verify SQL copied to clipboard!');
            }).catch(() => {
                alert('‚ùå Failed to copy. Please copy manually.');
            });
        }
    </script>
</body>
</html>
